(function($){const defaultTranslations={btnEmptyText:"Please select..",deselectAllText:"Deselect All",selectAllText:"Select All",searchText:"Search..",showSelectedText:function(count,total){return count+" of "+total+" selected"}};const translations=window.bsSelectTranslations||defaultTranslations;const WRAPPER_CLASS="js-bs-select-dropdown";$.bsSelect={setDefaults:function(options){this.DEFAULTS=$.extend({},this.DEFAULTS,options||{})},getDefaults:function(){const defCopy=this.DEFAULTS;delete defCopy.debug;delete defCopy.debugElement;return defCopy},DEFAULTS:{btnWidth:"fit-content",btnEmptyText:translations.btnEmptyText,btnSplit:false,dropDirection:null,dropIconClass:"bi bi-chevron-down",menuClass:null,menuHeaderClass:"text-bg-secondary text-uppercase",btnClass:"btn-outline-dark",search:true,menuPreHtml:null,menuAppendHtml:null,menuMaxHeight:300,showSubtext:true,showActionMenu:true,showMultipleCheckboxes:false,actionMenuBtnClass:"btn-light",showSelectionAsList:false,showSelectedText:translations.showSelectedText,deselectAllText:translations.deselectAllText,selectAllText:translations.selectAllText,checkedIcon:"bi bi-check-lg",debug:false,debugElement:null,menuItemClass:null,searchText:translations.searchText,onBeforeChange:null,onKeyDown:null}};function trigger($select,event,addParams=[]){let params=[];if(event!=="any.bs.select"){trigger($select,"any.bs.select");if(addParams.length){addParams.forEach(p=>{params.push(p)})}else{params.push($select.val())}$select.trigger(event,params)}else{$select.trigger(event)}const settings=$select.data("options");if(settings.debug){if(settings.debugElement!==null){const log=$("<small>",{class:"js-log border-bottom",html:"["+(new Date).toUTCString()+'] trigger <span class="text-warning">'+event+"</span> fired"}).prependTo(settings.debugElement);setTimeout(function(){log.remove()},5e3)}}}function getDropDown($select){return $select.closest(`.${WRAPPER_CLASS}`)}function show($select){const $dropdown=getDropDown($select);if($dropdown.length){$dropdown.dropdown("show")}}function hide($select){const $dropdown=getDropDown($select);if($dropdown.length){$dropdown.dropdown("hide")}}function setSelectValues($select){console.log("bsSelect:setSelectValues",$select.val());const $dropdown=getDropDown($select);const multiple=$select.prop("multiple");let values=[];$dropdown.find(".dropdown-item:not(.active)").find(".dropdown-item-select-icon").hide();$dropdown.find(".dropdown-item.active").each(function(i,element){let val=$select.find("option:eq("+$(element).data("index")+")").prop("value");if(val!==false){values.push(val);$(element).find(".dropdown-item-select-icon").show()}});if(multiple){$select.val(values)}else if(values.length){$select.val(values[0])}else{$select.val(null)}}function toggleAllItemsState($select,state=false){const dropdown=getDropDown($select);const options=$select.find("option");const settings=$select.data("options");const multiple=false!==$select.prop("multiple");options.prop("selected",state);const toggleCheckIcon=multiple&&settings.showMultipleCheckboxes;options.each(function(i){const $item=dropdown.find('.dropdown-item[data-index="'+i+'"]');if(state){$item.addClass("active");$item.find(".dropdown-item-select-icon").show()}else{$item.removeClass("active");$item.find(".dropdown-item-select-icon").hide()}});if(toggleCheckIcon){dropdown.find(".dropdown-item:not(.active) .js-icon-checklist.bi-check-square").removeClass("bi-check-square").addClass("bi-square");dropdown.find(".dropdown-item.active .js-icon-checklist.bi-square").removeClass("bi-square").addClass("bi-check-square")}setSelectValues($select);setDropdownTitle($select);const ev=state?"selectAll":"selectNone";trigger($select,ev+".bs.select");trigger($select,"change.bs.select")}function getBootstrapMajorVersion(){if(typeof $.fn.modal==="undefined"||typeof $.fn.modal.Constructor==="undefined"){console.error("Bootstrap Modal Plugin ist nicht verfÃ¼gbar");return}const bootstrapVersion=$.fn.modal.Constructor.VERSION;return parseInt(bootstrapVersion.split(".")[0])}function setupDropdown($dropdown,selectElement,multiple){var $dropdownToggle=$dropdown.find(".dropdown-toggle");const autoclose=$dropdownToggle.data("autoClose")||$dropdownToggle.data("bsAutoClose")||"true";const BS_V=getBootstrapMajorVersion();$dropdown.on("click",".js-select-select-all",function(e){e.preventDefault();if(onBeforeChange(selectElement)){toggleAllItemsState(selectElement,true);if(BS_V===4&&multiple&&(autoclose==="true"||autoclose==="outside")){e.stopPropagation()}}}).on("click",".js-select-select-none",function(e){e.preventDefault();if(onBeforeChange(selectElement)){toggleAllItemsState(selectElement,false);if(BS_V===4&&multiple&&(autoclose==="true"||autoclose==="outside")){e.stopPropagation()}}}).on("hidden.bs.dropdown",function(){let searchField=$(this).find('[type="search"]');if(searchField.length){const searchElements=$dropdown.find("[data-index]");searchElements.removeClass("d-none").addClass("d-flex");searchField.val(null).trigger("keyup")}}).on("keyup input",'[type="search"]',function(e){const searchField=$(e.currentTarget);const searchPattern=searchField.val().trim();console.log("bsSelect:search",searchPattern);const searchElements=$dropdown.find("[data-index]");searchElements.removeClass("d-none").addClass("d-flex");console.log("bsSelect:search elements:",searchElements.length);if(!isValueEmpty(searchPattern)){const search=searchPattern.toUpperCase();searchElements.each(function(index,value){let currentName=$(value).text().trim();if(currentName.toUpperCase().indexOf(search)>-1){console.log("bsSelect:search elements found:",currentName);$(value).removeClass("d-none").addClass("d-flex")}else{console.log("bsSelect:search elements not found:",currentName);$(value).addClass("d-none").removeClass("d-flex")}})}else{console.log("bsSelect:search is empty");searchElements.removeClass("d-none")}}).on("click",'[data-dismiss="dropdown"], [data-bs-dismiss="dropdown"]',function(e){const btn=$(e.currentTarget);const dd=btn.closest("."+WRAPPER_CLASS);dd.find('[data-bs-toggle="dropdown"],[data-toggle="dropdown"]').dropdown("hide")}).on("click",".dropdown-item",function(e){e.preventDefault();const settings=selectElement.data("options");if(onBeforeChange(selectElement)){const item=$(e.currentTarget);if(!multiple){$dropdown.find(".dropdown-item.active").not(item).removeClass("active")}item.toggleClass("active");const active=$(e.currentTarget).hasClass("active");const toggleCheckIcon=multiple&&settings.showMultipleCheckboxes;if(active){if(toggleCheckIcon){item.find(".js-icon-checklist").removeClass("bi-square").addClass("bi-check-square")}item.find(".dropdown-item-select-icon").show()}else{if(toggleCheckIcon){item.find(".js-icon-checklist").removeClass("bi-check-square").addClass("bi-square")}item.find(".dropdown-item-select-icon").hide()}setSelectValues(selectElement);setDropdownTitle(selectElement);trigger(selectElement,"change.bs.select");if(BS_V===4&&multiple&&(autoclose==="true"||autoclose==="outside")){e.stopPropagation()}}}).on("keydown",function(e){const $wrap=$(e.currentTarget);const $selectElement=$wrap.find("select");const settings=$selectElement.data("options");if(typeof settings.onKeyDown==="function"){settings.onKeyDown($selectElement,e)}trigger($selectElement,"keydown.bs.select",[$selectElement,e])}).on("keydown",'[type="search"]',function(e){switch(e.code){case"Enter":e.preventDefault();const item=$dropdown.find(".dropdown-item:visible:first");if(item.length){item.trigger("click");$dropdown.removeClass("show");$dropdown.find(".dropdown-menu").removeClass("show")}break;default:}}).on("hide.bs.dropdown",function(){const $select=$dropdown.find("select");trigger($select,"hide.bs.select")}).on("hidden.bs.dropdown",function(){const $select=$dropdown.find("select");trigger($select,"hidden.bs.select")}).on("show.bs.dropdown",function(){const $select=$dropdown.find("select");trigger($select,"show.bs.select")}).on("shown.bs.dropdown",function(){const $select=$dropdown.find("select");trigger($select,"shown.bs.select");const searchElement=$dropdown.find('[type="search"]');if(searchElement.length){searchElement.focus()}})}function isValueEmpty(value){if(value===null||value===undefined){return true}if(Array.isArray(value)){return value.length===0}if(typeof value==="string"){return value.trim().length===0}return false}function init($select,fireTrigger=false){console.log("bsSelect:init ->",$select.val());let $dropdown=getDropDown($select);const isSelectDisabled=$select.hasClass("disabled")||$select.is("[disabled]");if($dropdown.length){return $dropdown}const settings=$select.data("options");const multiple=$select.prop("multiple");console.log("bsSelect:init  selectedValue ++++->",$select.val());if(!multiple&&isValueEmpty($select.val())){$select.prop("selectedIndex",-1)}console.log("bsSelect:init  selectedValue ++++->",$select.val());let selectedValue=$select.val();$dropdown=$("<div>",{class:`${WRAPPER_CLASS} position-relative`,css:{width:settings.btnWidth}}).insertAfter($select);if(settings.dropDirection!==null){$dropdown.addClass(settings.dropDirection)}const toggleIconClass=settings.dropIconClass===null?"dropdown-toggle":"";const dropIcon=settings.dropIconClass!==null?`<i class="ms-2 ml-2 ${settings.dropIconClass}"></i>`:"";if(!settings.btnSplit){$("<button>",{class:`btn ${settings.btnClass} ${toggleIconClass} d-flex align-items-center flex-nowrap js-dropdown-header justify-content-between`,type:"button","data-bs-toggle":"dropdown","data-toggle":"dropdown","aria-expanded":false,"data-bs-auto-close":multiple?"outside":true,html:`<span class="js-selected-text">${settings.btnEmptyText}</span>${dropIcon}`,css:{width:settings.btnWidth}}).appendTo($dropdown)}else{$dropdown.addClass("btn-group");$("<button>",{class:`btn ${settings.btnClass} d-flex align-items-center js-dropdown-header justify-content-between`,type:"button",html:`<span class="js-selected-text">${settings.btnEmptyText}</span>`,css:{width:settings.btnWidth}}).appendTo($dropdown);$("<button>",{class:`btn ${settings.btnClass} dropdown-toggle dropdown-toggle-split`,"data-bs-toggle":"dropdown","data-toggle":"dropdown","aria-expanded":false,"data-bs-auto-close":multiple?"outside":true}).appendTo($dropdown)}const isDropDownInBootstrapTable=$dropdown.closest(".fixed-table-body:not(.overflow-visible)").length;if(isDropDownInBootstrapTable){$dropdown.closest(".fixed-table-body").addClass("overflow-visible")}setupDropdown($dropdown,$select,multiple);if($select.attr("id")){const selectId=$select.attr("id");const label=$(`label[for="${selectId}"]`);if(label.length){label.on("click",function(){const closestDropDown=getDropDown($(`select[id="${selectId}"]`));closestDropDown.trigger("click")})}}$select.appendTo($dropdown);$select.val(selectedValue);$select.css({position:"absolute",left:"0",opacity:"0",height:"0",width:"0"});const $dropdownMenu=$("<div>",{class:"dropdown-menu pl-1 ps-1 "+settings.menuClass??""}).appendTo($dropdown);let searchInput="";let closeButton="";let actionMenu="";if(true===settings.search){searchInput=`<input type="search" autocomplete="off" class="form-control form-control-sm mr-auto me-auto mr-auto" placeholder="${settings.searchText}">`}if(multiple){if(settings.showActionMenu){actionMenu=`<div class="d-flex flex-nowrap mt-2 p-0"><a href="#" class="btn-sm text-nowrap btn ${settings.actionMenuBtnClass} js-select-select-all">${settings.selectAllText}</a><span class="mx-1"></span><a href="#" class="btn-sm text-nowrap btn ${settings.actionMenuBtnClass} js-select-select-none">${settings.deselectAllText}</a></div>`}}let toolbarClasses="";if(searchInput!==""||closeButton!==""||actionMenu!==""){toolbarClasses="px-2 pb-2 pt-2 border-bottom"}$(`<div class="d-flex flex-column ${toolbarClasses}"><div class="d-flex  justify-content-end align-items-center">${searchInput}${closeButton}</div>${actionMenu}</div>`).appendTo($dropdownMenu);if(settings.menuPreHtml!==null){$("<div>",{html:settings.menuPreHtml,class:"text-muted p-3 fs-6"}).appendTo($dropdownMenu);$('<hr class="dropdown-divider mt-0">').appendTo($dropdownMenu)}const $dropdownMenuInner=$(`<div>`,{css:{overflowY:"auto",maxHeight:`${settings.menuMaxHeight}px`}}).appendTo($dropdownMenu);$dropdownMenu.find('[type="search"]').prop("autocomplete","off");let i=0;let inOGroup=false;const validElements=$select.find("optgroup, option");validElements.each(function(index,option){const element=$(option);const isOptGroup=element.is("optgroup");if(isOptGroup){$("<h6>",{class:`dropdown-header text-start my-0 w-100 rounded-0 py-1 ${settings.menuHeaderClass}`,text:element.attr("label")}).appendTo($dropdownMenuInner);return}const classList=element.get(0).className.trim();const value=element.prop("value");const inOptGroup=element.closest("optgroup").length!==0;const isDisabled=isSelectDisabled||element.is("[disabled]")||element.hasClass("disabled");const disabledClass=isDisabled?"disabled":"";let isSelected=false;let selected="";if(value!==false){if(multiple){isSelected=$.inArray(value,selectedValue)>-1;selected=isSelected?"active":""}else{isSelected=selectedValue===value;selected=isSelected?"active":""}}const showSubtext=settings.showSubtext&&element.data("subtext");const showCheckList=multiple&&settings.showMultipleCheckboxes;const showIcon=element.data("icon");const $subtext=showSubtext?`<small class="text-muted">${element.data("subtext")}</small>`:"";const $icon=showIcon?`<i class="${element.data("icon")}"></i> `:"";const paddingLeftClass=inOptGroup||$icon!==""?"ps-2 pl-2":"";let checkElement="";let checkElementPre="";if(showCheckList){checkElement=getCheckListIcon(isSelected)}else{checkElementPre=`<i class="${settings.checkedIcon}"></i>`}if(inOGroup&&!inOptGroup){$(`<hr>`,{class:"dropdown-divider"}).appendTo($dropdownMenuInner)}const itemClass=settings.menuItemClass===null?"":settings.menuItemClass;$("<div>",{tabindex:i,class:classList,html:`<a href="#" class="dropdown-item ${selected} ${disabledClass} px-2 d-flex flex-nowrap align-items-center ${itemClass} " data-index="${i}" style="cursor: pointer;">${checkElement}${$icon}<div class="${paddingLeftClass} d-flex flex-column"><div>${element.text()}</div>${$subtext}</div><div class="dropdown-item-select-icon pl-1 ps-1 ml-auto ms-auto ">${checkElementPre}</div></a>`}).appendTo($dropdownMenuInner);inOGroup=inOptGroup;i++});console.log("bsSelect:init before setSelectValues",$select.val());setSelectValues($select);if(settings.menuAppendHtml!==null){$(`<hr>`,{class:"dropdown-divider"}).appendTo($dropdownMenuInner);$("<div>",{html:settings.menuAppendHtml,class:"text-muted fs-6",css:{padding:"4px 16px"}}).appendTo($dropdownMenuInner)}setDropdownTitle($select);if(fireTrigger){setTimeout(function(){trigger($select,"init.bs.select");$dropdown.show()},0)}return $dropdown}function getCheckListIcon(isSelected){return isSelected?`<i class="bi bi-check-square mr-2 me-2 js-icon-checklist"></i>`:`<i class="bi bi-square me-2 mr-2 js-icon-checklist"></i>`}function setDropdownTitle($select){const settings=$select.data("options");const $dropdown=getDropDown($select);const $titleElement=$dropdown.find(".js-dropdown-header .js-selected-text");let selectedValues=$select.val();let title;let tooltip="";if(!selectedValues||!selectedValues.length||selectedValues===""||!$select.find("option:selected").length){title=settings.btnEmptyText}else{if(Array.isArray(selectedValues)){if(selectedValues.length===1){let $option=$select.find(`option[value="${selectedValues[0]}"]`);let $subtext=settings.showSubtext&&$option.data("subtext")?`<small class="text-muted mx-2">${$option.data("subtext")}`:"";let $icon=$option.data("icon")?`<i class="${$option.data("icon")}"></i> `:"";title=`<span>${$icon}${$option.text()}</span><small class="text-muted ms-2 ml-2">${$subtext}</small>`;tooltip=$option.text()}else{if(!settings.showSelectionAsList){let length=$select.find("option").length;title=settings.showSelectedText(selectedValues.length,length);let tooltips=[];selectedValues.forEach(val=>{let $option=$select.find(`option[value="${val}"]`);tooltips.push($option.text())});tooltip+=tooltips.join(",")}else{let texts=[];let tooltips=[];selectedValues.forEach(val=>{let $option=$select.find(`option[value="${val}"]`);let $subtext=settings.showSubtext&&$option.data("subtext")?$option.data("subtext"):"";let $icon=$option.data("icon")?`<i class="${$option.data("icon")}"></i> `:"";texts.push(`<div><span>${$icon}${$option.text()}</span><small class="text-muted ms-2 ml-2">${$subtext}</small></div>`);tooltips.push($option.text())});title=`<div class="d-flex flex-column">${texts.join("")}</div>`;tooltip+=tooltips.join(",")}}}else{let $option=$select.find(`option[value="${selectedValues}"]`);if($option.hasClass("d-none")){title=settings.btnEmptyText}else{let $subtext=settings.showSubtext&&$option.data("subtext")?`<small class="text-muted ms-2 ml-2">${$option.data("subtext")}`:"";let $icon=$option.data("icon")?`<i class="${$option.data("icon")}"></i> `:"";title=`<span>${$icon}${$option.text()}</span><small class="text-muted mx-2">${$subtext}</small>`;tooltip=$option.text()}}}$titleElement.html(title);$titleElement.attr("title",tooltip)}function val($select){const $dropdown=getDropDown($select);$dropdown.find(".dropdown-item.active").removeClass("active");$dropdown.find(".dropdown-item .js-icon-checklist.bi-check-square").removeClass("bi-check-square").addClass("bi-square");const disabledDropdownIcons=$dropdown.find(".dropdown-item.disabled");disabledDropdownIcons.removeClass("disabled");let selectedValues=$select.val();if(!Array.isArray(selectedValues)){selectedValues=[selectedValues]}selectedValues.forEach(value=>{let index=$select.find(`option[value="${value}"]`).index();const item=$dropdown.find(`.dropdown-item[data-index="${index}"]`);item.addClass("active")});$dropdown.find(".dropdown-item.active .js-icon-checklist.bi-square").removeClass("bi-square").addClass("bi-check-square");setSelectValues($select);trigger($select,"change.bs.select");setDropdownTitle($select);disabledDropdownIcons.addClass("disabled")}function destroy($select,show,clearData=false){console.log("bsSelect:destroy");let val=$select.val();console.log("bsSelect:destroy value before: ",val);let $dropdown=getDropDown($select);$select.insertBefore($dropdown);$select.val(val);console.log("bsSelect:destroy value after: ",$select.val());if(clearData){$select.removeData("options")}$dropdown.remove();if(show){$select.css({position:"",left:"",opacity:"",height:"",width:""})}}function refresh($select){destroy($select,false,false);init($select,false)}function onBeforeChange($select){const settings=$select.data("options");if(typeof settings.onBeforeChange==="function"){const ok=settings.onBeforeChange($select);if(ok){trigger($select,"acceptChange.bs.select")}else{trigger($select,"cancelChange.bs.select")}return ok}return true}$.fn.bsSelect=function(options,param){let callFunction=false;let optionsSet=false;switch(typeof options){case"string":{callFunction=true}break;default:{optionsSet=true}break}return $(this).each(function(index,select){const $select=$(select);if(optionsSet){const setup=$.extend({},$.bsSelect.DEFAULTS,$select.data(),options||{});$select.data("options",setup)}init($select,true);if(callFunction){switch(options){case"selectAll":{if(onBeforeChange($select)){toggleAllItemsState($select,true)}}break;case"selectNone":{if(onBeforeChange($select)){toggleAllItemsState($select,false)}}break;case"hide":{hide($select)}break;case"show":{show($select)}break;case"val":{if(onBeforeChange($select)){$select.val(param);val($select)}}break;case"destroy":{trigger($select,"destroy.bs.select");destroy($select,true,param)}break;case"updateOptions":{$select.data("options",$.extend({},$.bsSelect.DEFAULTS,$select.data("options"),param||{}));refresh($select);trigger($select,"update.bs.select")}break;case"refresh":{refresh($select);trigger($select,"refresh.bs.select")}break}}return $select})};$(document).ready(function(){$('[data-bs-toggle="select"],[data-toggle="select"]').bsSelect()})})(jQuery);